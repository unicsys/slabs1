# <<< CHANGE THIS to your Node 22 folder >>>
$myNode = 'C:\Users\E40058770\node'

# Read current user & system PATHs
$u = [Environment]::GetEnvironmentVariable('Path','User')
$s = [Environment]::GetEnvironmentVariable('Path','Machine')

# Build a new user PATH:
#  - put your Node 22 first
#  - keep existing USER paths (minus the old Program Files\nodejs, just in case)
#  - copy SYSTEM paths into USER (minus Program Files\nodejs) so you don't lose tools
$paths =
  @($myNode) +
  ($u -split ';' | Where-Object { $_ -and $_ -ne 'C:\Program Files\nodejs' }) +
  ($s -split ';' | Where-Object { $_ -and $_ -ne 'C:\Program Files\nodejs' })

# Deduplicate & write back to USER PATH
$new = ($paths | Select-Object -Unique) -join ';'
[Environment]::SetEnvironmentVariable('Path', $new, 'User')

'User PATH updated. Close and reopen CMD/PowerShell windows.'

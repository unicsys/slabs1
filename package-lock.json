import requests
import urllib.parse

# --- Configuration ---
MOBI_HOST = "https://localhost:8443"
API_TOKEN = "your_full_api_token_here"

def find_catalog_iris():
    """
    Connects to Mobi to discover and list all available Catalog IRIs.
    """
    if "your_full_api_token_here" in API_TOKEN:
        print("Error: Please update the API_TOKEN in the script.")
        return

    url = f"{MOBI_HOST}/mobirest/catalogs"
    headers = {'Cookie': f'mobi_web_token={API_TOKEN}'}
    
    print("Finding available catalogs in Mobi...")

    try:
        # Suppress warnings for localhost development
        requests.packages.urllib3.disable_warnings()
        response = requests.get(url, headers=headers, verify=False)
        response.raise_for_status()
        
        catalogs = response.json()

        if not catalogs:
            print("\nNo catalogs found for this Mobi instance.")
            return
            
        print("\n--- Available Catalogs ---")
        for catalog in catalogs:
            # Extract the human-readable title and the essential IRI
            title = catalog.get('http://purl.org/dc/terms/title', [{}])[0].get('@value', 'No Title')
            iri = catalog.get('@id')
            
            print(f"{title}")
            print(f"  IRI: {iri}\n")

    except requests.exceptions.RequestException as e:
        print(f"\nAPI request failed: {e}")

if __name__ == "__main__":
    find_catalog_iris()
